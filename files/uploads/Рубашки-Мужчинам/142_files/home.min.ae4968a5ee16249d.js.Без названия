(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
"use strict";!function(){const e=require("../modules/home/homeRecommendationsLoader"),t=[{name:"hits",targetUrl:"MI",sizeForDynamicGoods:49,sizeForStaticGood:70,dataUrl:"/homeRecommendedGoods",analiticsCode:"MCS"},{name:"visited",targetUrl:"RG",sizeForDynamicGoods:49,sizeForStaticGood:14,dataUrl:"/webapi/goods/visited-nm",analiticsCode:"MCV"}],n=[{blockType:0,data:[],chunk:4,start:1,rows:3,bannerType:"sm",analiticsCode:"MBT"},{blockType:1,data:{showTitle:!0,rowLength:7,startCardIndex:0,rowsCount:1,blockName:"hits",advertCount:1,advertPositions:[2],advIndex:0},analiticsCode:"MCS"},{blockType:0,data:[],chunk:4,start:4,rows:2,bannerType:"sm",analiticsCode:"MBG"},{blockType:1,data:{rowLength:7,startCardIndex:7,rowsCount:1,blockName:"hits",advertCount:1,advertPositions:[3],advIndex:1},analiticsCode:"MCS"},{blockType:0,data:[],chunk:2,start:1,rows:1,bannerType:"st",analiticsCode:"MBH"},{blockType:1,data:{rowLength:7,startCardIndex:14,rowsCount:2,blockName:"hits",advertCount:2,advertPositions:[1,4],advIndex:2},analiticsCode:"MCS"},{blockType:0,data:[],chunk:2,start:2,rows:1,bannerType:"st",analiticsCode:"MBH"},{blockType:3,analticsCode:""},{blockType:1,data:{rowLength:7,startCardIndex:28,rowsCount:1,blockName:"hits",advertCount:1,advertBoundaries:[1,2],advIndex:4},analiticsCode:"MCS"},{blockType:0,data:[],chunk:2,start:3,rows:1,bannerType:"st",analiticsCode:"MBH"},{blockType:1,data:{rowLength:7,startCardIndex:35,rowsCount:5,blockName:"hits",enableShowMoreBtn:!0,advertCount:5,advertBoundaries:[1,2],advIndex:5},analiticsCode:"MCS"},{blockType:1,data:{showTitle:!0,rowLength:7,startCardIndex:0,rowsCount:2,blockName:"visited",enableShowMoreBtn:!0},analiticsCode:"MCV"}];let a=function(){function a(a){this.blocks=n,this._setBanners(a.bannersTask,a.banners),this.recommendationsLoaders=t.reduce((t,n)=>(t.set(n.name,e.create(n)),t),new Map),this.blocks.forEach(e=>{if(1==e.blockType){const t=this.recommendationsLoaders.get(e.data.blockName);e.data.id=btoa(this.$generateGuid()),t.addBlock(e.data)}}),this.canShowStories=wb.global.settings.switches.showWbStoriesOnMainPage,this.bottomTextOpened=!1,this.lazyLoader=null,this.updateLazyLoaderEvent=this._updateLazyLoader.bind(this,null),this.loadStories=this.loadStories.bind(this),this._onChangeDisplayMode=this._onChangeDisplayMode.bind(this)}var o=a.prototype;return o.onBeforeRender=async function(){$.observe(wb.settings,"displayMode",this._onChangeDisplayMode)},o._onChangeDisplayMode=async function(){const e=await this.$services.bannersService.getBannersForHomePageAsync();$.observable(this).setProperty({mainBanners:e.mainBanners})},o.onAfterRender=async function(){document.addEventListener("DynamicCarouselRendered",this.updateLazyLoaderEvent),this.recommendationsLoaders.forEach(e=>e.init());const e=this.$moduleLoader.loadModuleAsync("lazyImageLoader").then(e=>(this.lazyLoader=new e(document.documentElement),Promise.resolve()));this.promoBanners=this._initPromoBanner(),this._initSeo(),this.$stat.banners.sendStatisticNow(),this.$stat.banners.initClickEvent(),this.quickNavDestroyer=wb.quickNav({bottomPx:document.documentElement.clientHeight}),await Promise.all([e,this.recommendationsLazyLoader(e)]),this._updateLazyLoader()},o.getScreenName=function(){return"Main"},o.onBeforeUnrender=function(){var e,t,n,a,o,s;$.unobserve(wb.settings,"displayMode",this._onChangeDisplayMode),document.removeEventListener("DynamicCarouselRendered",this.updateLazyLoaderEvent),null===(e=this.quickNavDestroyer)||void 0===e||e.call(this),null===(t=this.lazyLoader)||void 0===t||t.destroy(),null===(n=this.promoBanners)||void 0===n||n.destroy(),null===(a=this.stories)||void 0===a||a.destroy(),this.$stat.banners.destroyClickEvent(),this.recommendationsLoaders.forEach(e=>{e.destroy()}),null===(o=this.recommendationsObserver)||void 0===o||o.destroy(),null===(s=this.verticalObserver)||void 0===s||s.destroy()},o.onHistoryChange=function(){this._initSeo()},o.renderCarousel=function(e){const{data:t}=$.view(e.currentTarget);if(!t)return;const n=this.recommendationsLoaders.get(t.data.blockName);n&&n.renderCarousel(t.data.id)},o.recommendationsLazyLoader=async function(e){const t=document.querySelectorAll(".j-goods-wrapper");if(navigator.userAgent.indexOf("MSIE ")>0||navigator.userAgent.indexOf("Trident/")>0)return await e,t.forEach(e=>e.dispatchEvent(new CustomEvent("elementInViewportEvent",{bubbles:!0})));this.recommendationsObserver=this.$observerHelper.getVerticalObserver(t.toArray(),{rootMargin:"200px"}),this.recommendationsObserver.observe()},o.loadStories=async function(){if((await this.$user.getUserInfo()).isAuth){const e=await this.$moduleLoader.loadModuleAsync("wbStories");this.stories=new e(e.template),this.stories.init()}},o._setBanners=async function(e,t){const n=!t;n&&(t=await e),$.observable(this).setProperty({mainBanners:t.mainBanners}),this.blocks.forEach(e=>{var n,a;0==e.blockType&&("sm"===e.bannerType&&null!==(n=t.smallBanners)&&void 0!==n&&n.length&&$.observable(e).setProperty({data:this._buildBannerRows(t.smallBanners,e.chunk,e.start,e.rows)}),"st"===e.bannerType&&null!==(a=t.stripBanners)&&void 0!==a&&a.length&&$.observable(e).setProperty({data:this._buildBannerRows(t.stripBanners,e.chunk,e.start,e.rows)}))}),this._bannersShownStat(),n&&this._updateLazyLoader()},o._initSeo=async function(){var e;this.seoData=null!==(e=this.seoData)&&void 0!==e?e:await this.$httpClient.fetchJSON("/webapi/api/home/seo"),this.$seoHelper.render(this.seoData.metaTags),this.$setActionPayRetargetingModel(this.seoData.actionPayRetargetingModel),this.$setGoogleTagsModel(this.seoData.googleTagParamsModel),this.$observable.setProperty({bottomText:this.seoData.bottomText})},o._bannersShownStat=function(){this.verticalObserver=this.$stat.banners.bannerBlockShownStatWba(this)},o._initPromoBanner=function(){let e=[];const t=function(){if(window.innerWidth>1023)for(;e.length>0;){let t=e[0];null==t||t.destroy(!0,!0),e.splice(0,1)}else 0==e.length&&(e=n())},n=function(){var e=new Swiper(".j-promo-banners",{slidesPerView:1,loop:!0,effect:"fade",fadeEffect:{crossFade:!0},lazy:{loadPrevNext:!0},pagination:{el:".j-promo-banners-pagination",type:"bullets",dynamicBullets:!0,clickable:!0}});return e=Array.isArray(e)?e:[e]};return window.addEventListener("resize",t),t(),{destroy:function(){for(;e.length>0;){let t=e[0];t.initialized&&t.destroy(!0,!0),e.splice(0,1)}window.removeEventListener("resize",t)}}},o._updateLazyLoader=function(e){var t;null===(t=this.lazyLoader)||void 0===t||t.update(document.querySelectorAll("img[data-original], picture[data-original]").toArray(),e)},o._buildBannerRows=function(e,t,n,a){let o=[];for(let s=0;s<a;s++){let a=this._buildSingleBannersRow(e,t,n+s);null!==a&&o.push(a)}return o},o._buildSingleBannersRow=function(e,t,n){let a=(n-1)*t+1+500,o=e.filter(e=>e.placementOptions.sort>=a&&e.placementOptions.sort<a+t).reduce((e,t)=>((e[t.placementOptions.sort]=e[t[t.placementOptions.sort]]||[]).push(t),e),{}),s=Object.values(o);return s.length===t?s:null},a}();wb.spa.registerViewModel(a)}();

},{"../modules/home/homeRecommendationsLoader":3}],2:[function(require,module,exports){
"use strict";function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _inheritsLoose(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}module.exports=(t=>(function(t){function e(e,i){var n;return(n=t.call(this,e,{cardSelector:".j-product-item",isCarouselCard:!0})||this).getAnaliticsCode=i.getAnaliticsCode,n.targetUrl=i.targetUrl,n.analiticsData={onCardOpen:n.onCardOpen.bind(_assertThisInitialized(n)),onCardClick:n.onCardClick.bind(_assertThisInitialized(n))},n}_inheritsLoose(e,t);var i=e.prototype;return i.onCardClick=function(t){this._updateAnalitics(t)},i.onCardOpen=function(t){this._updateAnalitics(t)},i.setProducts=function(t){this.allProducts=this.allProducts.concat(null!=t?t:[])},i._updateAnalitics=function(t){const e=t.currentTarget,{data:i}=$.view(e);let{analiticsCode:n,start:r}=e.closest(".j-goods-wrapper").dataset;const o=parseInt(e.dataset.index)+parseInt(r);if(n=i.isAdv?"MAB":n){const t={l:n,iid:(isNaN(o)?0:o)+1};var s,a;if(i.isAdv)t.t="",t.t1=null!==(s=i.advertId)&&void 0!==s?s:-1,t.t2=null!==(a=i.cpm)&&void 0!==a?a:-1,t.t3="";this.$analitic.saveState(t)}},e})(t));

},{}],3:[function(require,module,exports){
"use strict";const HomeVisitedRecommendationsLoader=require("./recommendationsLoader/visitedRecommendationsLoader"),HomeHitsRecommendationsLoader=require("./recommendationsLoader/hitRecommendationsLoader");let RecommedationsLoaderFactory=function(){function e(){}return e.create=function(e){switch(e.name){case"visited":return new HomeVisitedRecommendationsLoader(e);case"hits":default:return new HomeHitsRecommendationsLoader(e)}},e}();module.exports=RecommedationsLoaderFactory;

},{"./recommendationsLoader/hitRecommendationsLoader":4,"./recommendationsLoader/visitedRecommendationsLoader":7}],4:[function(require,module,exports){
"use strict";function _inheritsLoose(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}const HomeRecommendationsLoader=require("./recommendationsLoader"),SERVICE_URL="https://main-page.wildberries.ru/api/v2/site-recommendation";let HomeHitsRecommendationsLoader=function(t){function e(e){var s;return(s=t.call(this,e)||this).adverts=[],s.advGoods=[],s.includeSoldOut=!1,s.checkedAdvCount=0,s.user=null,s}_inheritsLoose(e,t);var s=e.prototype;return s.provideGoodsAsync=function(t,e,s=0,o=0){return this.nmIdsLoaded&&0==this.nms.length?{goods:[],adv:[]}:this.goods.length>=t+e&&this.advGoods.length>=s+o?{goods:this.goods.slice(t,t+e),adv:this.advGoods.slice(s,s+o)}:this.goods.length>=t+e&&this.nmIdsLoaded&&this.checkedAdvCount>=this.adverts?{goods:this.goods.slice(t,t+e),adv:[]}:this.nmIdsLoaded&&this.checkedNmCount>=this.nms.length?{goods:this.goods.slice(t,t+e),adv:[]}:this._loadGoods(t,e,s,o)},s._loadGoods=async function(t,e,s,o){let i;if(this.nmIdsLoaded||await this._loadNmIds(),this.goodsChunksCache.has(this.currentChunk))i=this.goodsChunksCache.get(this.currentChunk);else{const t=this.goods.length,e=this.advGoods.length,s=this.nms.length-this.checkedNmCount,n=this.adverts.length-this.checkedAdvCount,d=Math.min(Math.ceil((t+this.chunkSize-7*e)/8),n)*(o>0),r=Math.min(s,this.chunkSize-d),h=this.nms.slice(this.checkedNmCount,this.checkedNmCount+r),a=this.adverts.slice(this.checkedAdvCount,this.checkedAdvCount+d),c=a.map(t=>t.id),l=a.toMap(t=>t.id,t=>t);this.checkedNmCount+=r,this.checkedAdvCount+=d,i=wb.xnm.getGoodsForRecommendAndCatalog([...h,...c],this.includeSoldOut,!0).then(t=>(t.forEach(t=>{if(l.has(t.cod1S)){var e;const s=l.get(t.cod1S);t.isAdv=!0,t.advertId=s.advertId,t.cpm=s.cpm,t.subjectId=null!==(e=t.subjectId)&&void 0!==e?e:s.subject,t.brandId=s.brand,this.advGoods.push(t)}else this.goods.push(t)}),Promise.resolve(t))),this.goodsChunksCache.set(this.currentChunk,i)}return await i,this.currentChunk++,this.provideGoodsAsync(t,e,s,o)},s._loadNmIds=async function(){var t,e,s,o,i;if(this.loadNmIdsTask)return this.loadNmIdsTask;const n=new this.$helper.Deferred;this.loadNmIdsTask=n.promise;const d=this.$services.cartService.getItems().map(t=>t.cod1S);null==this.user&&(this.user=await("any"in Promise?Promise.any([this.$user.getUserInfo(),new Promise(t=>setTimeout(t,2e3))]):this.$user.getUserInfo()));const r=await this.$analitic.getSplitterHeaders(),h=this.$recentViews.get(),a={count:1e3,referrer:null!==(t=null===(e=this.$router)||void 0===e?void 0:e.referrer)&&void 0!==t?t:"",locale:WbSpaModel.prototype.$user.getLocale()};(null===(s=h.nm)||void 0===s?void 0:s.length)>0&&(a.nms=h.nm.slice(0,10)),(null===(o=h.url)||void 0===o?void 0:o.length)>0&&(a.urls=h.urls),(null===(i=h.query)||void 0===i?void 0:i.length)>0&&(a.queries=h.query),d.length>0&&(a.basket_nms=d);try{var c;const t=await this.$httpClient.fetchBasicJSON(SERVICE_URL,{method:"POST",body:JSON.stringify(a),credentials:"omit",headers:r},{timeout:1e4});var l;if((null==t?void 0:null===(c=t.nms)||void 0===c?void 0:c.length)>0)this.isPersonal=1===t.flag,this.nms=t.nms,this.adverts=null!==(l=t.adverts)&&void 0!==l?l:[]}catch(t){console.error(t)}finally{this.nmIdsLoaded=!0,n.resolve()}},e}(HomeRecommendationsLoader);module.exports=HomeHitsRecommendationsLoader;

},{"./recommendationsLoader":6}],5:[function(require,module,exports){
"use strict";function _inheritsLoose(t,o){t.prototype=Object.create(o.prototype),t.prototype.constructor=t,_setPrototypeOf(t,o)}function _setPrototypeOf(t,o){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,o){return t.__proto__=o,t})(t,o)}let RecommendationsBlock=function(t){function o(o){var s;return(s=t.call(this)||this).id=o.id,s.goods=[],s.ordiaryGoods=[],s.advGoods=[],s.startIndex=o.startCardIndex,s.rowLength=o.rowLength,s.rowsCount=o.rowsCount,s.goodsCount=o.rowLength*o.rowsCount,s.advIndex=o.advIndex,s.advCount=o.advertCount,s.advPositions=o.advertPositions,s.advBoundaries=o.advertBoundaries,s.showTitle=o.showTitle,s.name=o.blockName,s.targetUrl=o.targetUrl,s.enableShowMoreBtn=o.enableShowMoreBtn,s.isPersonal=!1,s.getHomeCardsManager=o.getHomeCardsManager,s}_inheritsLoose(o,t);var s=o.prototype;return s.setGoods=function(t){this.ordiaryGoods=t},s.setAdvertGoods=function(t){this.advGoods=null!=t?t:[]},s.setShowMoreBtn=function(t){$.observable(this).setProperty({showBtn:this.enableShowMoreBtn&&t})},s.setIsPersonal=function(t){this.isPersonal=t},s.addGoods=function(t){$.observable(this.goods).insert(null!=t?t:[]),this.homeCardsManager.setProducts(this.goods)},s.render=async function(t){this.goods=this.ordiaryGoods.slice(0,this.goodsCount),this.advCount>0&&this.advGoods.length>0&&this.mergeAdvGoods(),this.homeCardsManager||(this.homeCardsManager=await this.getHomeCardsManager()),this.homeCardsManager.setProducts(this.goods),this.cardsManagerDataLinkActions=this.homeCardsManager.getDataLinkActions("homeCardsManager"),$.link.newrecommendedgoods(t,this)},s.mergeAdvGoods=function(){for(let s=0;s<this.advGoods.length;s++){var t;const e=this.advGoods[s];let n=null===(t=this.advPositions)||void 0===t?void 0:t[s];if(null==n){var o;const[t,s]=null!==(o=this.advBoundaries)&&void 0!==o?o:[1,this.rowLength];n=t+Math.floor(Math.random()*(s+1-t))}n=this.rowLength*s+(n-1),e.advPostion=n+1,this.goods[n]=e}},s.sendAdvertShowEvent=function(){this.goods.filter(t=>t.isAdv).forEach(t=>{const o=this._getAdvStatParam(t);this.$stat.sendEvent("AREMS",o)})},s.sendAdvertClickEvent=function(t){const{data:o}=$.view(t.currentTarget);o&&this.$stat.sendEvent("AREMC",this._getAdvStatParam(o),!0)},s.renderDynamicGoods=function(){this.setShowMoreBtn(!1);const t={id:this.id,startIndex:this.startIndex,goodsCount:this.goods.length};this.$eventBus.dispatchEvent(new CustomEvent("RecommendationBlockRequireGoods",{detail:t}))},s.beforeRouterTransition=function(t){const{data:o}=$.view(t.currentTarget);null==o||o.isService||this.$services.productCard.stashCatalogProduct(o)},s._getAdvStatParam=function(t){return[this.$stat.wrapParam("PARAM1",0),this.$stat.wrapParam("PARAM2",t.advertId),this.$stat.wrapParam("PARAM3",t.cod1S),this.$stat.wrapParam("PARAM4",t.advPostion),this.$stat.wrapParam("PARAM5",t.cpm),this.$stat.wrapParam("PARAM6",t.subjectId)]},o}(WbSpaModel);module.exports=RecommendationsBlock;

},{}],6:[function(require,module,exports){
"use strict";function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _inheritsLoose(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}const RecommendationsBlock=require("./recommendationsBlock"),HomeCardsManager=require("../homeRecommendationsCard");let HomeRecommendationsLoader=function(e){function t(t){var o;return(o=e.call(this)||this).dataUrl=t.dataUrl,o.name=t.name,o.sizeForDynamicGoods=t.sizeForDynamicGoods,o.sizeForStaticGood=t.sizeForStaticGood,o.targetUrl=t.targetUrl,o.title=t.title,o.analiticsCode=t.analiticsCode,o.isPersonal=!1,o.nmIdsLoaded=!1,o.nms=[],o.goods=[],o.chunkSize=100,o.currentChunk=1,o.goodsChunksCache=new Map,o.checkedNmCount=0,o.blocks=new Map,o.onGoodsRequired=o.onGoodsRequired.bind(_assertThisInitialized(o)),o.getHomeCardsManager=o.getHomeCardsManager.bind(_assertThisInitialized(o)),o.initHomeCardsManagerTask=o._initHomeCardsManager(),o}_inheritsLoose(t,e);var o=t.prototype;return o.init=function(){this._bindEvents()},o.destroy=function(){var e;this._unbindEvents(),null===(e=this.homeCardsManager)||void 0===e||e.destroy()},o.onGoodsRequired=async function(e){var t;const{id:o,startIndex:n,goodsCount:s}=null!==(t=e.detail)&&void 0!==t?t:{};if(!this.blocks.has(o))return;const i=this.blocks.get(o),{goods:a=[]}=await this.provideGoodsAsync(n+s,this.sizeForDynamicGoods+1),d=a.slice(0,this.sizeForDynamicGoods);i.addGoods(d),i.setShowMoreBtn(a.length>this.sizeForDynamicGoods),document.dispatchEvent(new CustomEvent("DynamicCarouselRendered")),this._sendViewItemListStateWba(d)},o.addBlock=function(e){const t={targetUrl:this.targetUrl,sizeForDynamicGoods:this.sizeForDynamicGoods,getHomeCardsManager:this.getHomeCardsManager,...e};this.blocks.set(e.id,new RecommendationsBlock(t))},o.renderCarousel=async function(e){var t,o;const n=this.blocks.get(e),s=document.getElementById(e);if(null==n||null==s||n.goods.length>0)return;const[i]=await Promise.all([this.provideGoodsAsync(n.startIndex,n.goodsCount,n.advIndex,n.advCount),$.views.loadTemplateAsync("newrecommendedgoods")]),{goods:a=[],adv:d=[]}=null!=i?i:{};(null==a?void 0:a.length)<1&&s.classList.add("hide"),n.setGoods(a),n.setAdvertGoods(d),n.setIsPersonal(this.isPersonal),n.setShowMoreBtn(this.goods.length+(null!==(t=null===(o=this.advGoods)||void 0===o?void 0:o.length)&&void 0!==t?t:0)>this.sizeForStaticGood),await n.render(s),n.sendAdvertShowEvent(),document.dispatchEvent(new CustomEvent("DynamicCarouselRendered")),this._sendViewItemListStateWba(n.goods)},o.getHomeCardsManager=async function(){return this.homeCardsManager||await this.initHomeCardsManagerTask,this.homeCardsManager},o._initHomeCardsManager=async function(){const e=(await this.$moduleLoader.loadModuleAsync("catalogCore")).getCatalogCardBaseActionsBinderClass(),t=HomeCardsManager(e);this.homeCardsManager=new t(null,{targetUrl:this.targetUrl,getAnaliticsCode:this._getAnaliticsCode.bind(this)}),this.homeCardsManager.init()},o._getAnaliticsCode=function(e){return e.isAdv?"MAB":this.analiticsCode},o._sendViewItemListStateWba=function(e){const t=e.map((e,t)=>{var o;const n=[this._getAnaliticsCode(e),"","PP","",e.isAdv?e.advertId:"",e.isAdv?e.cpm:"",""];return{id:null===(o=e.nmId)||void 0===o?void 0:o.toString(),name:e.name,brand:e.brand,price:e.priceWithCouponAndDiscount,inListIndex:t+1,listName:n.join("|"),subjectId:e.subjectId,subjectParentId:e.subjectParentId}}),o={page:1,link:window.location.origin,goods:e.length};this.$analitic.sendWbaEcomStat("view_item_list",t,o)},o._bindEvents=function(){this.$eventBus.addEventListener("RecommendationBlockRequireGoods",this.onGoodsRequired)},o._unbindEvents=function(){this.$eventBus.removeEventListener("RecommendationBlockRequireGoods",this.onGoodsRequired)},t}(WbSpaModel);module.exports=HomeRecommendationsLoader;

},{"../homeRecommendationsCard":2,"./recommendationsBlock":5}],7:[function(require,module,exports){
"use strict";function _inheritsLoose(t,o){t.prototype=Object.create(o.prototype),t.prototype.constructor=t,_setPrototypeOf(t,o)}function _setPrototypeOf(t,o){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,o){return t.__proto__=o,t})(t,o)}const HomeRecommendationsLoader=require("./recommendationsLoader");let HomeVisitedRecommendationsLoader=function(t){function o(o){var s;return(s=t.call(this,o)||this).visitedLocally=!1,s.includeSoldOut=!0,s}_inheritsLoose(o,t);var s=o.prototype;return s.provideGoodsAsync=function(t,o){return this.nmIdsLoaded&&0==this.nms.length?{goods:[]}:this.goods.length>=t+o?{goods:this.goods.slice(t,t+o)}:this.nmIdsLoaded&&this.checkedNmCount>=this.nms.length?{goods:this.goods.slice(t,t+o),adv:[]}:this._loadGoods(t,o)},s._loadGoods=async function(t,o){let s;if(this.nmIdsLoaded||await this._loadNmIds(t,o),!this.nmIdsLoaded&&this.visitedLocally&&this.nms.length<t+o&&await this._loadNmIds(t,o),this.goodsChunksCache.has(this.currentChunk))s=this.goodsChunksCache.get(this.currentChunk);else{const t=this.nms.slice(this.checkedNmCount,this.checkedNmCount+this.chunkSize);this.checkedNmCount+=t.length,s=wb.xnm.getGoodsForRecommendAndCatalog(t,this.includeSoldOut,!0),this.goodsChunksCache.set(this.currentChunk,s)}const e=await s;return this.goods.push(...null!=e?e:[]),this.currentChunk++,this.provideGoodsAsync(t,o)},s._loadNmIds=async function(){if(!this.visitedLocally)return this._loadLocalNms();if(this.loadNmIdsTask)return this.loadNmIdsTask;const t=new this.$helper.Deferred;this.loadNmIdsTask=t.promise;try{var o,s;const e=await this.$httpClient.fetchBasicJSON(this.dataUrl,{method:"POST",body:null},{timeout:2e3});let i=(null==e?void 0:null===(o=e.value)||void 0===o?void 0:null===(s=o.nmsArr)||void 0===s?void 0:s.length)>0?e.value.nmsArr:[];const n=this.nms.toHashSet();i=i.filter(t=>!n.has(t)),this.nms.push(...i)}catch(t){console.error(t)}finally{this.nmIdsLoaded=!0,t.resolve()}},s._loadLocalNms=function(){var t;this.visitedLocally=!0;const o=this.$recentViews.get(),s=(null===(t=o.nm)||void 0===t?void 0:t.length)>0?o.nm:[];this.nms.push(...s)},o}(HomeRecommendationsLoader);module.exports=HomeVisitedRecommendationsLoader;

},{"./recommendationsLoader":6}]},{},[1]);
